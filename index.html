<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>‡πÄ‡∏Å‡∏° : ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå‡∏õ‡∏£‡∏∞‡∏™‡∏°‡∏Ñ‡∏≥</title>
<style>
/* ===== ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏£‡∏ß‡∏°‡∏´‡∏ô‡πâ‡∏≤ (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡∏°‡πÄ‡∏î‡∏¥‡∏°) ===== */
@font-face{
  font-family: 'MyGameFont';
  src: url('image/THSarabunNew.woff2') format('woff2'),
       url('image/THSarabunNew.woff') format('woff'),
       url('image/THSarabunNew.ttf') format('truetype');
  font-weight: 400; font-style: normal; font-display: swap;
}
@font-face{
  font-family: 'MyGameFont';
  src: url('image/THSarabunNewBold.woff2') format('woff2'),
       url('image/THSarabunNewBold.woff') format('woff'),
       url('image/THSarabunNewBold.ttf') format('truetype');
  font-weight: 700; font-style: normal; font-display: swap;
}
html, body, button, input, select, textarea, .pill, .btn, .btn-mini,
.levelBtn, #startTitle, #countdown, .label, #timer {
  font-family: 'MyGameFont', system-ui, -apple-system, 'Segoe UI', Arial, sans-serif;
}

:root{ --glass: rgba(0,0,0,.45); --ok:#10b981; --bad:#ef4444; }
*{ box-sizing:border-box }
html,body{ height:100%; margin:0 }
body{
  background: url("image/background2.png") center center / cover no-repeat fixed !important;
  overflow:hidden; color:#fff;
}
#game{ position:relative; width:100vw; height:100vh; overflow:hidden }

/* ===== HUD (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ===== */
.hud{ position:fixed; inset:26px 12px auto 38px; display:flex; align-items:center; gap:12px; justify-content:space-between; pointer-events:none; z-index:15000 }
.hud .left,.hud .right{ display:flex; align-items:center; gap:12px }
.pill{ background:var(--glass); backdrop-filter:blur(6px); padding:8px 12px; border-radius:999px; box-shadow:0 4px 18px rgba(0,0,0,.25) }
#timer{ font-weight:700; font-variant-numeric:tabular-nums; letter-spacing:.5px; font-size:20px }
.btn-mini{ pointer-events:auto; background:#1f2937; color:#fff; border:none; border-radius:12px; padding:8px 12px; font-weight:800; cursor:pointer; box-shadow:0 4px 18px rgba(0,0,0,.25) }
.btn-mini:hover{ filter:brightness(1.1) }
.hud .right { align-items: flex-end; }
.hud .right .stack { align-items: flex-end; }
.hud .right .pill{ text-align:right }

.score-label{
  font-size: 20px;       /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
  font-weight: 900;      /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤ */
  color: #fff;           /* ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß ‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏±‡∏î‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
  margin-bottom: 6px;    /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ ‚Äú‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‚Äù ‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á pill */
  text-align: center;
width: 100%;
margin-top: -4px;
}


/* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏≠‡∏á: ‡∏•‡πá‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î */
.pill.gold{
  /* === ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ === */
  --gold-size: 28px;  /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥/‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç */
  --gold-gap: 6px;    /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç */
  --gold-cols: 5;    /* ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ï‡πà‡∏≠‡πÅ‡∏ñ‡∏ß (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î) */
  --gold-rows: 1;     /* ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î) */

  /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏° */
  display:flex;
  flex-wrap:wrap;
  gap: var(--gold-gap);
  background: var(--glass);
  border-radius: 999px;
  padding: 8px 12px;
  line-height: 1;

  /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß = (‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç + ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á) + padding ‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏ß‡∏≤/‡∏ö‡∏ô‡∏•‡πà‡∏≤‡∏á */
  width: calc(
    (var(--gold-cols) * var(--gold-size)) +
    ((var(--gold-cols) - 1) * var(--gold-gap)) +
    (12px + 12px)   /* padding-left + padding-right */
  );
  height: calc(
    (var(--gold-rows) * var(--gold-size)) +
    ((var(--gold-rows) - 1) * var(--gold-gap)) +
    (8px + 8px)     /* padding-top + padding-bottom */
  );

  /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢-‡∏´‡∏î */
  min-width:  calc(
    (var(--gold-cols) * var(--gold-size)) +
    ((var(--gold-cols) - 1) * var(--gold-gap)) +
    (12px + 12px)
  );
  max-width:  calc(
    (var(--gold-cols) * var(--gold-size)) +
    ((var(--gold-cols) - 1) * var(--gold-gap)) +
    (12px + 12px)
  );
  min-height: calc(
    (var(--gold-rows) * var(--gold-size)) +
    ((var(--gold-rows) - 1) * var(--gold-gap)) +
    (8px + 8px)
  );
  max-height: calc(
    (var(--gold-rows) * var(--gold-size)) +
    ((var(--gold-rows) - 1) * var(--gold-gap)) +
    (8px + 8px)
  );

  /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥/‡∏£‡∏π‡∏õ */
  font-size: var(--gold-size);
}

/* ‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç */
.pill.gold .bar{
  display:inline-block;
  width: var(--gold-size);
  height: var(--gold-size);
  transform: translateY(0);
  /* ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ <img> ‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°: object-fit: contain; */
}

/* (‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å) ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ö‡∏ô‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
@media (max-width: 480px){
  .pill.gold{
    --gold-size: 24px;
    --gold-cols: 8;
    --gold-rows: 2;
  }
}



/* ===== Landing ===== */
#landing{ position: fixed; inset: 0; display: flex; flex-direction: column; gap: 22px; align-items: center; justify-content: center; background: url("image/background2.png") center/cover no-repeat fixed !important; z-index: 20000; transition: opacity .3s ease }
#landing.hide{ opacity:0; pointer-events:none; visibility:hidden }
#landing .brand{ width: min(92vw, 1100px) }
#landing .brand img{ width:100%; height:auto; display:block; filter:drop-shadow(0 10px 30px rgba(0,0,0,.6)) }

/* ===== Welcome (‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î) ===== */
#welcome{
  position: fixed; inset: 0;
  background: url("image/welcome.png") center/cover no-repeat fixed;
  display: flex;
  flex-direction: column;          /* üëà ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
  align-items: center;             /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
  justify-content: center;         /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
  gap: 24px;                       /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° */
  z-index: 25000;
  transition: opacity .3s ease;
}

#welcome.hide{ opacity:0; pointer-events:none; visibility:hidden }

#welcome #enterBtn{
  padding: 12px 28px;
  font-size: clamp(22px, 4vw, 36px);
  font-weight: 1000; letter-spacing:.2px;
  border: 0; border-radius: 16px;
  color: #fff; background: rgba(0,0,0,.55);
  box-shadow: 0 10px 28px rgba(0,0,0,.35);
  cursor: pointer; backdrop-filter: blur(6px);
  border:1px solid rgba(255,255,255,.18);
}
#welcome #enterBtn:hover{ filter: brightness(1.08) }
/* Banner ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Welcome */
#welcome .brand{
  width: min(90vw, 1000px);
  margin-bottom: 24px;
  display:flex; justify-content:center;
}
#welcome .brand img{
  width:100%; height:auto; display:block;
  animation: pulse 3s infinite ease-in-out;
  filter: drop-shadow(0 6px 18px rgba(0,0,0,.45));
}

/* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏£‡∏ß‡∏° banner + ‡∏õ‡∏∏‡πà‡∏° */
#welcome .welcome-content{
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0px;
  margin-top: 450px;          /* üëà ‡∏Ç‡∏¢‡∏±‡∏ö‡∏•‡∏á‡∏°‡∏≤ (‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏Ç‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) */
}

/* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå pulse ‡πÄ‡∏ö‡∏≤ ‡πÜ */
@keyframes pulse{
  0%, 100% { transform: scale(1); opacity: 1; }
  50%      { transform: scale(1.04); opacity: 0.9; }
}


.level-menu{ display:flex; flex-direction:column; gap:14px; width:min(92vw, 640px) }
.levelBtn{ width:100%; padding:10px 16px; font-size: clamp(20px, 4vw, 34px); font-weight: 1000; letter-spacing:.2px; border: 0; border-radius: 14px; color: #fff; background: rgba(0,0,0,.55); box-shadow: 0 10px 28px rgba(0,0,0,.35); cursor: pointer; text-align:center; border:1px solid rgba(255,255,255,.18); backdrop-filter: blur(6px) }
.levelBtn:hover{ filter: brightness(1.08) }

/* ===== ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°/‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á ===== */
#startScreen{ position:fixed; inset:0; display:none; flex-direction:column; align-items:center; justify-content:center; background:rgba(0,0,0,.9); z-index:9999; text-align:center; padding:24px }
#startTitle{ font-size:clamp(26px,5vw,48px); font-weight:900; margin-bottom:10px }
#startBtn{ margin-top:12px; padding:10px 18px; border:0; border-radius:12px; font-weight:800; cursor:pointer; background:#1f2937; color:#fff }
#startBtn:hover{ filter:brightness(1.1) }
#countdown{ display:none; font-size:clamp(56px,12vw,120px); font-weight:1000; line-height:1; margin-top:8px }

/* ===== ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ ===== */
#guideScreen{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:url("image/background2.png") center/cover no-repeat; z-index: 20001 }
#guideScreen .guide-wrap{ width:min(95vw, 1200px); max-height:92vh; display:flex; flex-direction:column; gap:10px; align-items:center; justify-content:center }
#guideScreen img{ width:100%; height:auto; max-height:92vh; border-radius:14px; box-shadow:0 20px 60px rgba(0,0,0,.55); display:block }
#guideScreen .guide-close{ align-self:flex-end; margin-top:8px; background:#1f2937; color:#fff; border:none; border-radius:12px; padding:8px 12px; font-weight:800; cursor:pointer }
#guideScreen .guide-close:hover{ filter:brightness(1.1) }

/* ===== ‡∏õ‡πä‡∏≠‡∏õ‡∏≠‡∏±‡∏õ‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô ===== */
#overlay{ position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.55); visibility:hidden; opacity:0; transition:.25s; z-index:9999 }
#overlay.show{ visibility:visible; opacity:1 }
.panel{ background:rgba(20,20,20,.9); border:1px solid rgba(255,255,255,.1); padding:22px 26px; border-radius:20px; min-width:320px; text-align:center; box-shadow:0 20px 60px rgba(0,0,0,.5) }
.panel h1{ margin:0 0 6px; font-size:28px }
.panel p{ margin:8px 0 18px; opacity:.85 }
.btn{ background:#1f2937; color:#fff; border:none; border-radius:12px; padding:10px 16px; font-weight:700; cursor:pointer }
.btn:hover{ filter:brightness(1.1) }
.actions{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:10px }
#overlay .btn { padding: 12px 24px; font-size: 20px; font-weight: 900; border-radius: 18px; min-width: 180px }
#restartBtn { background:#1f2937 } #restartBtn:hover{ filter:brightness(1.1) }
#selectLevelBtn { background:#2563eb } #selectLevelBtn:hover{ background:#1d4ed8 }
#nextLevelBtn { background:#10b981 } #nextLevelBtn:hover{ background:#059669 }

/* ===== ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ + ‡πÄ‡∏á‡∏≤) ===== */
#questionBox {
  position: absolute;
  top: 60px;                /* üëà ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
  left: 50%;
  transform: translateX(-50%);
  
  background: none;         /* ‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤‡∏Å‡∏•‡πà‡∏≠‡∏á */
  border: none;             /* ‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤‡∏Å‡∏£‡∏≠‡∏ö */
  padding: 0;               /* ‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á */
  
  font-size: clamp(28px, 4.5vw, 56px); /* üëà ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ */
  font-weight: 1000;
  color: #fff;              /* ‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ */
  text-shadow: 0 4px 12px rgba(0,0,0,.8); /* üëà ‡πÄ‡∏á‡∏≤‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ */
  
  z-index: 10;
  white-space: pre;      /* <-- ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç */
  overflow: visible;     /* <-- ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç */
  text-align: center;
}


/* ===== ‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå‡πÅ‡∏ö‡∏ö‡∏†‡∏≤‡∏û + ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤ ===== */
.option{
  position:absolute;
  cursor:pointer;
  user-select:none;

  background: transparent;
  box-shadow: none;
  border: none;

  width: var(--img-w, 260px);
  height: var(--img-h, 180px);

  /* ‚¨áÔ∏è ‡πÄ‡∏û‡∏¥‡πà‡∏° transform ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏±‡∏ö ‚Äò‡∏Å‡∏•‡πà‡∏≠‡∏á‚Äô ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ö = hitbox ‡∏Ç‡∏¢‡∏±‡∏ö‡∏ï‡∏≤‡∏° */
  transform: translate(var(--opt-offset-x, 0), var(--opt-offset-y, 0));

  transition: left 2000ms cubic-bezier(.2,.9,.2,1),
              right 2000ms cubic-bezier(.2,.9,.2,1),
              transform 2000ms cubic-bezier(.2,.9,.2,1);
  will-change: left, right, transform;
  border-radius:16px;
}


/* ‡∏£‡∏π‡∏õ‡∏à‡∏£‡∏¥‡∏á: ‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏ï‡πá‡∏°‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏™‡∏°‡∏≠ */
.option .opt-bg{
  position:absolute;
  inset:0;
  width: 100%;
  height: 100%;
  object-fit: contain;
  pointer-events:none;
  border-radius:16px;
  z-index:1;
}

/* ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏û‡∏≠) */
.option .opt-label{
  position:absolute; left:50%; top:50%;
  transform: translate(calc(-50% + var(--label-offset-x,0)),
                      calc(-50% + var(--label-offset-y,0)));
  color:#fff; text-shadow:0 3px 10px rgba(0,0,0,.6);
  font-size: clamp(28px,3.6vw,42px);
  font-weight:900;
  white-space:nowrap;
  z-index:2;
  pointer-events:none;
}

/* ‡∏†‡∏≤‡∏û‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°) */
/* ===== ‡∏†‡∏≤‡∏û‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° Q1 (‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ñ‡∏á‡∏ó‡∏µ‡πà) ===== */
#questionImg{
  position:absolute;
  top: var(--qimg-top, -300px);
  left:50%;
  transform: translate(calc(-50% + var(--qimg-x, 0px)), var(--qimg-y, -80px));

  /* ‚úÖ ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà: 800px (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏•‡∏Ç‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) */
  width: 800px;
    max-width: 90vw;   /* ‡∏Å‡∏±‡∏ô‡∏•‡πâ‡∏ô‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
  height: auto;

  /* ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠-‡∏Ç‡∏¢‡∏≤‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ */
  max-width: none;

  z-index:0;
  opacity:.9;
  pointer-events:none;
  display:none;
}

@media (max-width: 1024px){
  #questionImg{ width: 640px; }
  #questionBox{ font-size: 56px; }
  .option{ width: 360px; height: 248px; }
}

@media (max-width: 768px){
  #questionImg{ width: 520px; }
  #questionBox{ font-size: 44px; }
  .option{ width: 300px; height: 210px; }
}

@media (max-width: 480px){
  #questionImg{ width: 360px; }
  #questionBox{ font-size: 32px; }
  .option{ width: 240px; height: 168px; }
}


/* ===== ‡πÅ‡∏ñ‡∏ö‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ ===== */
#timebarWrap{ position:fixed; left:0; right:0; bottom:0; height:12px; background:rgba(255,255,255,.12); z-index:16000; border-top:1px solid rgba(255,255,255,.2) }
#timebar{
  height:100%;
  width:0%;
  background:#10b981;              /* ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏•‡πâ‡∏ß‡∏ô */
  transition: width .1s linear;     /* ‡πÉ‡∏´‡πâ JS ‡∏Ñ‡∏∏‡∏°‡∏™‡∏µ‡πÅ‡∏ó‡∏ô */
}


/* ===== ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÅ‡∏ü‡∏•‡∏ä‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏à‡∏≠ ===== */
#flash{ position:fixed; inset:0; background:transparent; pointer-events:none; z-index:17000 }
.flash-green{ animation: flashG 300ms ease-out }
.flash-red{ animation: flashR 300ms ease-out }
@keyframes flashG{ 0%{background:rgba(16,185,129,.35)} 100%{background:transparent} }
@keyframes flashR{ 0%{background:rgba(239,68,68,.35)} 100%{background:transparent} }
.flash-clear{ animation: flashC 2000ms ease-out }
@keyframes flashC{ 0%{background:rgba(255,255,255,.55)} 100%{background:transparent} }

/* ===== Flash-in effect (‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö #roundToast ‡πÅ‡∏•‡∏∞ #ansImg) ===== */
.flash-in{
  animation: flashIn .35s ease-out;
}

@keyframes flashIn{
  0%{
    opacity: 0;
    transform: translate(-50%, -50%) scale(1.04);
    box-shadow:
      0 0 0 0 rgba(255,255,255,0),
      0 0 0 0 rgba(255,255,255,0);
  }
  30%{
    opacity: 1;
    box-shadow:
      0 0 24px 6px rgba(255,255,255,.75),
      0 0 64px 12px rgba(255,255,255,.55);
  }
  100%{
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
    box-shadow: none;
  }
}

/* ===== Flash-in effect (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏û‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠) ===== */
.flash-in-cover{
  animation: flashInCover .35s ease-out;
}

@keyframes flashInCover{
  0%{
    opacity: 0;
    box-shadow:
      0 0 0 0 rgba(255,255,255,0),
      0 0 0 0 rgba(255,255,255,0);
  }
  30%{
    opacity: 1;
    box-shadow:
      0 0 24px 6px rgba(255,255,255,.75),
      0 0 64px 12px rgba(255,255,255,.55);
  }
  100%{
    opacity: 1;
    box-shadow: none;
  }
}

/* ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏•‡∏∑‡πà‡∏ô */
#roundToast, #ansImg{ will-change: opacity, transform, box-shadow; }


/* ===== Toast ‡∏£‡∏≠‡∏ö (‡πÅ‡∏Å‡πâ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠) ===== */
#roundToast{
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  background: rgba(0,0,0,.78);
  border: 1px solid rgba(255,255,255,.22);
  padding: 18px 26px;
  border-radius: 16px;
  font-size: clamp(22px, 3vw, 34px);
  font-weight: 900;
  z-index: 17500;
  display: none;
  text-align: center;

  /* üëá ‡πÉ‡∏´‡πâ‡∏Ç‡∏ô‡∏≤‡∏î ‚Äú‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏à‡∏£‡∏¥‡∏á‚Äù */
    width: auto;             /* ‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á */
  max-width: none;         /* ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î */
  white-space: nowrap;     /* ‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏≠‡∏á */
  line-height: 1.25;
}

/* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏¢‡πà‡∏≠‡∏¢ */
#roundToast .q{ display:block; }
#roundToast .a{ display:block; margin-top:.15em; opacity:.95; }
#roundToast .r{ display:block; margin-top:.35em; font-weight:1000; }
#roundToast .r.ok{ color: var(--ok); }
#roundToast .r.bad{ color: var(--bad); }



/* ===== ‡∏†‡∏≤‡∏û‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ===== */
#ansImg{
  position: fixed;
  inset: 0;              /* ‡∏Ñ‡∏£‡∏≠‡∏ö‡πÄ‡∏ï‡πá‡∏° viewport */
  width: 100vw;
  height: 100vh;
  object-fit: cover;     /* ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠‡πÅ‡∏ö‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô */
  object-position: center;
  opacity: .95;
  filter: drop-shadow(0 20px 60px rgba(0,0,0,.50));
  z-index: 17499;        /* ‡πÉ‡∏ï‡πâ #roundToast */
  display: none;
  pointer-events: none;
  transform: none;       /* ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ translate(-50%,-50%) ‡πÅ‡∏•‡πâ‡∏ß */
}


/* ===== ‡∏Å‡∏•‡πâ‡∏≠‡∏á / ‡πÅ‡∏Ñ‡∏ô‡∏ß‡∏≤‡∏™ AR ===== */
#cameraMirror{ position:fixed; inset:0; width:100vw; height:100vh; object-fit:cover; transform: scaleX(-1); z-index:1; display:none; background:#000 }
#camCanvas{ position:fixed; inset:0; width:100vw; height:100vh; z-index:2; pointer-events:none; display:none }
#game{ z-index:3; position:relative }

/* ===== ‡∏õ‡∏∏‡πà‡∏° Mute / Fullscreen ===== */
#muteBtn, #fsBtn{ position:fixed; right:12px; width:44px; height:44px; border-radius:999px; background:rgba(0,0,0,.45); border:1px solid rgba(255,255,255,.3); color:#fff; font-size:18px; line-height:1; display:grid; place-items:center; cursor:pointer; z-index:10000 }
#muteBtn{ bottom:12px }
#fsBtn{ bottom:62px }

/* ===== ‡∏°‡∏∏‡∏°‡∏ã‡πâ‡∏≤‡∏¢/‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö ===== */
body::after{ content:""; position: fixed; top: 0; left: 0; width: var(--corner-img-w, 220px); height: var(--corner-img-h, 220px); background: url("image/button1.png") no-repeat left top / contain; pointer-events: none; z-index: 10000 }
body::before{ content:""; position: fixed; top: 0; right: 0; width: var(--corner2-img-w, 200px); height: var(--corner2-img-h, 200px); background: url("image/button2.png") no-repeat right top / contain; pointer-events: none; z-index: 10000 }

/* ===== ‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡∏£‡∏π‡∏õ ===== */
.option { position: absolute; } /* ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏Ç‡πâ‡∏≤‡∏° */
.option .opt-label{
  position:absolute;
  /* ‡πÉ‡∏ä‡πâ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏™‡πà‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å JS */
  left: var(--label-left, 50%);
  top:  var(--label-top, 50%);
  transform: translate(-50%,-50%);
  white-space:nowrap;
  font-weight:900;
  color:#fff;
  text-shadow:0 3px 10px rgba(0,0,0,.6);
  pointer-events:none;
}

</style>
</head>
<body>

<!-- ==== AR Mirror ==== -->
<video id="cameraMirror" playsinline muted></video>
<canvas id="camCanvas"></canvas>

<div id="game" aria-label="‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏Å‡∏°">
  <img id="questionImg" src="" alt="‡∏†‡∏≤‡∏û‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°" />
  <div id="questionBox" aria-live="polite"></div>
</div>

<!-- ===== Welcome (‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î) ===== -->
<div id="welcome" role="dialog" aria-modal="true">
  <div class="welcome-content">
    <div class="brand">
      <img src="image/banner2.png" alt="Banner">
    </div>
    <button id="enterBtn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÄ‡∏Å‡∏°</button>
  </div>
</div>


<!-- ===== Landing ===== -->
<div id="landing" role="dialog" aria-modal="true" class="hide">
  <div class="brand"><img src="image/banner2.png" alt="Banner"></div>
  <div class="level-menu">
    <button class="levelBtn" data-level="0" data-src="levels/level1.json">‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏£</button>
       <button class="levelBtn" data-level="1" data-src="levels/level2.json">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏£</button>
    <button class="levelBtn" id="guideBtn">‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô üìñ</button>
  </div>
</div>

<!-- ===== ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à / ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° ===== -->
<div id="startScreen">
  <div id="startTitle">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à: ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡πÇ‡∏î‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</div>
  <button id="startBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°</button>
  <div id="countdown">3</div>
</div>

<!-- ===== ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ ===== -->
<div id="guideScreen">
  <div class="guide-wrap">
    <img src="image/guide.png" alt="‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÄ‡∏Å‡∏°">
    <button id="guideBack" class="btn-mini guide-close">‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>
  </div>
</div>

<!-- ===== HUD ===== -->
<div class="hud">
  <div class="left">
    <div class="stack">
      <div style="display:flex; gap:8px;">
        <button id="quickRestart" class="btn-mini">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
        <button id="pauseBtn" class="btn-mini">‚è∏ ‡∏´‡∏¢‡∏∏‡∏î</button>
        <button id="camBtn" class="btn-mini">üì∑: ‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </div>

  <div class="right">
    <div class="stack" style="align-items:flex-end">
      <div class="score-label">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
      <div id="goldWrap" class="pill gold" aria-live="polite" title="‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô"></div>
    </div>
  </div>
</div>


<!-- ===== ‡πÅ‡∏ñ‡∏ö‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ 5 ‡∏ß‡∏¥ ‡∏•‡πà‡∏≤‡∏á‡∏à‡∏≠ ===== -->
<div id="timebarWrap" aria-hidden="true"><div id="timebar"></div></div>
<div id="flash"></div>
<div id="roundToast"></div>
<img id="ansImg" src="" alt="answer background">


<!-- ===== ‡∏õ‡πä‡∏≠‡∏õ‡∏≠‡∏±‡∏õ‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô ===== -->
<div id="overlay">
  <div class="panel">
    <h1 id="endTitle">‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô</h1>
    <p>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢: <b id="finalScore">0</b></p>
    <p>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö: <b id="finalRounds">0</b></p>
    <div class="actions">
      <button class="btn" id="restartBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
      <button class="btn" id="selectLevelBtn">‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
      <button class="btn" id="nextLevelBtn">‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    </div>
  </div>
</div>

<!-- ===== ‡πÄ‡∏™‡∏µ‡∏¢‡∏á ===== -->
<audio id="hitSound" preload="auto" src="image/audio1.mp3"></audio>
<audio id="winSound" preload="auto" src="image/win2.mp3"></audio>
<audio id="bgm" preload="auto" loop src="image/bgm3.mp3"></audio>
<audio id="selectSound" preload="auto" src="image/select.mp3"></audio>


<!-- ===== ‡∏õ‡∏∏‡πà‡∏° Mute / Fullscreen ===== -->
<button id="muteBtn" aria-pressed="false" title="Mute / Unmute">üîä</button>
<button id="fsBtn" aria-pressed="false" title="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠">‚õ∂</button>

<!-- ===== ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Mute ===== -->
<script>
(function(){
  const muteBtn = document.getElementById('muteBtn');
  if(!muteBtn) return;
  let isMuted = false;
  function applyMute(m){
    isMuted = !!m;
    document.querySelectorAll('audio').forEach(a => { a.muted = isMuted; if(isMuted){ a.setAttribute('muted',''); } else { a.removeAttribute('muted'); } });
    muteBtn.setAttribute('aria-pressed', String(isMuted));
    muteBtn.textContent = isMuted ? 'üîá' : 'üîä';
  }
  muteBtn.addEventListener('click', () => applyMute(!isMuted));
})();
</script>

<!-- ===== ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Fullscreen ===== -->
<script>
(function(){
  const fsBtn = document.getElementById('fsBtn');
  if (!fsBtn) return;
  function fsEnabled(){ return document.fullscreenEnabled || document.webkitFullscreenEnabled || document.msFullscreenEnabled }
  function isFull(){ return document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement }
  function requestFS(){ const el=document.documentElement; (el.requestFullscreen||el.webkitRequestFullscreen||el.msRequestFullscreen)?.call(el) }
  function exitFS(){ (document.exitFullscreen||document.webkitExitFullscreen||document.msExitFullscreen)?.call(document) }
  function render(){ const on=!!isFull(); fsBtn.setAttribute('aria-pressed', String(on)); fsBtn.title = on ? '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠' : '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠'; fsBtn.textContent = on ? 'üóó' : '‚õ∂' }
  if (!fsEnabled()){ fsBtn.style.display='none'; return }
  fsBtn.addEventListener('click', () => { if(isFull()) exitFS(); else requestFS() });
  document.addEventListener('fullscreenchange', render);
  document.addEventListener('webkitfullscreenchange', render);
  document.addEventListener('msfullscreenchange', render);
  render();
})();
</script>

<!-- ===== ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡∏°‡πÅ‡∏ö‡∏ö‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå ===== -->
<script>
(()=>{
  /* ---------- DOM refs ---------- */
  const game = document.getElementById('game');
  const qBox = document.getElementById('questionBox');
  const timebar = document.getElementById('timebar');
  const timebarWrap = document.getElementById('timebarWrap');
  const flash = document.getElementById('flash');
  const toast = document.getElementById('roundToast');

  const overlay = document.getElementById('overlay');
  const endTitleEl = document.getElementById('endTitle');
  const finalScoreEl = document.getElementById('finalScore');
  const finalRoundsEl = document.getElementById('finalRounds');
  const restartBtn = document.getElementById('restartBtn');
  const selectLevelBtn = document.getElementById('selectLevelBtn');
  const nextLevelBtn = document.getElementById('nextLevelBtn');

  const scoreEl = document.getElementById('score');
  const roundEl = document.getElementById('round');
const goldWrap = document.getElementById('goldWrap');
const GOLD = 'üíé'; // ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á ü™ô üí∞ ‡πÑ‡∏î‡πâ

// ===== Welcome -> Landing =====
(function(){
  const welcome = document.getElementById('welcome');
  const enterBtn = document.getElementById('enterBtn');
  const landing = document.getElementById('landing');
  if(!welcome || !enterBtn || !landing) return;

  enterBtn.addEventListener('click', ()=>{
    welcome.classList.add('hide');
    landing.classList.remove('hide');
  });
})();

function renderGold(score){
  if(!goldWrap) return;
  goldWrap.innerHTML = '';
  for(let i=0;i<score;i++){
    const span = document.createElement('span');
    span.className = 'bar';
    span.textContent = GOLD;
    goldWrap.appendChild(span);
  }
  goldWrap.setAttribute('aria-label', `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ${score}`);
}


  const hitSound = document.getElementById('hitSound');
  const winSound = document.getElementById('winSound');
  const bgm = document.getElementById('bgm');
  const selectSound = document.getElementById('selectSound');

/* ===== Backend per-sound volume (0..1) ===== */
const VOL_BGM    = 0.35; // ‡πÄ‡∏û‡∏•‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
const VOL_SELECT = 0.75; // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå
const VOL_HIT    = 0.75; // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏à‡∏ö‡∏£‡∏≠‡∏ö (‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î)
const VOL_WIN    = 0.85; // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ä‡∏ô‡∏∞‡∏î‡πà‡∏≤‡∏ô

function applyBackendVolume(){
  if (bgm) bgm.volume = VOL_BGM;
  if (selectSound) selectSound.volume = VOL_SELECT;
  if (hitSound)    hitSound.volume    = VOL_HIT;
  if (winSound)    winSound.volume    = VOL_WIN;
}
applyBackendVolume();

/* ‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ mute ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö */
function isGlobalMuted(){
  const a = document.querySelector('audio');
  return !!a && a.muted === true;
}

/* ‡πÄ‡∏•‡πà‡∏ô SFX ‡πÇ‡∏î‡∏¢‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏ß‡∏•‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á + ‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û mute */
function playSfx(el, vol){
  try{
    const n = el?.cloneNode(true);
    if(!n) return;
    n.volume = typeof vol === 'number' ? Math.max(0, Math.min(1, vol)) : (el.volume ?? 1);
    n.muted  = isGlobalMuted();
    n.play?.();
  }catch(_){}
}




  // util
  const rand = (min,max)=> Math.floor(Math.random()*(max-min+1))+min;
  const pick = (arr)=> arr[rand(0,arr.length-1)];

  function buildWord_L1(){
    const c = pick(CONS);
    const v = pick(VOW_SIMPLE);
    const q = `${c}-${v}`;
    const ans = combine(c, v, "");
    return { question:q, answer:ans, pieces:[c,v] };
  }
  function buildWord_L2(){
    const c = pick(CONS);
    const v = pick([...VOW_SIMPLE, "‡∏≠‡∏≤", "‡∏≠‡∏¥", "‡∏≠‡∏∏"]);
    const f = pick(FINAL_SET);
    const q = `${c}-${v}-${f}`;
    const ans = combine(c, v, f);
    return { question:q, answer:ans, pieces:[c,v,f] };
  }
  function buildWord_L3(){
    const c = pick(CONS);
    const patterns = [
      { show:`‡πÄ-${c}-‡∏∞`, make: (c)=> `‡πÄ${c}‡∏∞` },
      { show:`‡πÄ-${c}-‡∏≤`, make: (c)=> `‡πÄ${c}‡∏≤` },
      { show:`‡πÑ-${c}`,   make: (c)=> `‡πÑ${c}` },
      { show:`‡πÉ-${c}`,   make: (c)=> `‡πÉ${c}` },
      { show:`‡πÇ-${c}`,   make: (c)=> `‡πÇ${c}` }
    ];
    const p = pick(patterns);
    const question = p.show.replaceAll(c, "-").replace("-", c);
    const ans = p.make(c);
    return { question, answer: ans, pieces:[c] };
  }
  function buildWord_L4(){
    const c = pick(CONS);
    const patterns = [
      { q:`${c}-‡∏ß-‡∏≤`, a:`${c}‡∏ß‡∏≤` },
      { q:`${c}-‡∏ß-‡∏¥`, a:`${c}‡∏ß‡∏¥` },
      { q:`${c}-‡∏¢-‡∏≤`, a:`${c}‡∏¢‡∏≤` },
      { q:`${c}-‡∏£-‡∏≤`, a:`${c}‡∏£‡∏≤` }
    ];
    const p = pick(patterns);
    return { question:p.q, answer:p.a, pieces:[c] };
  }

  function combine(c, v, f){
    const full = ["‡πÄ‡∏≠","‡πÇ‡∏≠","‡πÑ‡∏≠","‡πÉ‡∏≠","‡∏≠‡∏≤","‡∏≠‡∏¥","‡∏≠‡∏∏"];
    if(full.includes(v)) return (v + c + (f||""));
    return (c + v + (f||""));
  }

  function makeDistractors(answer){
    const set = new Set([answer]);
    while(set.size < 4){
      let a = answer.split("");
      const idx = rand(0, Math.max(0,a.length-1));
      if(/[‡πÄ‡πÇ‡πÑ‡πÉ‡∏≠]/.test(a[0]) && idx===0){
        const choices = ["‡πÄ","‡πÇ","‡πÑ","‡πÉ"]; a[0] = pick(choices);
      }else{
        const repl = pick([...CONS, ...FINAL_SET]);
        a[idx] = repl;
      }
      set.add(a.join(""));
    }
    return shuffle(Array.from(set)).slice(0,4);
  }
  function shuffle(arr){ const A=arr.slice(); for(let i=A.length-1;i>0;i--){ const j=(Math.random()*(i+1))|0; [A[i],A[j]]=[A[j],A[i]] } return A }

// ===== Glow ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å =====
function clearOptionGlows(){
  document.querySelectorAll('.opt-bg').forEach(img => {
    img.style.transition = '';
    img.style.filter = '';
  });
}
function glowGold(img){
  if(!img) return;
  img.style.transition = 'filter .14s ease';
  img.style.filter =
    'brightness(1.05) ' +
    'drop-shadow(0 0 10px rgba(250,204,21,.70)) ' +
    'drop-shadow(0 0 18px rgba(250,204,21,.55))';
}


  /* ---------- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏Å‡∏° ---------- */
  const MAX_ROUNDS = 10; 
    const WIN_SCORE = 5; 
    const ROUND_TIME = 10;
  const BLANK_MS=3000, Q_DROP_MS=2000, Q_HOLD_MS=3000, OPT_IN_MS=2000, RESULT_MS=3000;
  let selectedLevel = 0;
  let running=false, ended=false, paused=false;
  let score=0, round=0; 
  let roundTimer=null; 
  let timeLeft=ROUND_TIME; 
  let awaitingAnswer=false; 
  let correctThisRound="";
// ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô ‚Äú‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô
let selectedEl = null;
let selectedText = '';
let selectedOk = null; // true/false ‡∏´‡∏£‡∏∑‡∏≠ null (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)


  function updateHUD(){
  renderGold(score);
}
  function resetState(){ score=0; round=0; timeLeft=ROUND_TIME; awaitingAnswer=false; correctThisRound=""; updateHUD(); qBox.style.top='-160px'; clearRoundObjects(); stopTimebar() }
  function clearRoundObjects(){ document.querySelectorAll('.option').forEach(n=>n.remove()) }
  
function showToast(payload){
  const ansImg = document.getElementById('ansImg');

  // ‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà { q, a, ok } (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ï‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡πà‡∏≤ ‡∏à‡∏∞ fallback ‡πÄ‡∏õ‡πá‡∏ô q)
  const data = (typeof payload === 'object' && payload) ? payload : { q:String(payload||''), a:'', ok:false };
  const { q = '', a = '', ok = false } = data;

  // escape HTML ‡∏Å‡∏±‡∏ô‡∏´‡∏•‡∏∏‡∏î
  const esc = (s)=> String(s||'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]));

  // ‡∏à‡∏±‡∏î 3 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î: 1) ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡πÑ‡∏°‡πà‡∏°‡∏µ '=')  2) ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å  3) ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á/‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
  const qHTML = esc(q);
  const aHTML = esc(a || '‚Äî');
  const rHTML = ok ? '‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á' : '‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';

  toast.innerHTML = `
    <span class="q">${qHTML}</span>
    <span class="a">${aHTML}</span>
    <span class="r ${ok?'ok':'bad'}">${rHTML}</span>
  `;
  toast.style.display = 'inline-block'; // ‡πÉ‡∏´‡πâ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå

  // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏†‡∏≤‡∏û ans1 (‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠) ‡∏Å‡πá‡πÇ‡∏ä‡∏ß‡πå‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)
  if (ansImg){
    ansImg.onerror = () => { ansImg.style.display = 'none'; };
    ansImg.src = 'image/ans1.png';   // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏Å‡∏∏‡∏•‡∏ï‡∏≤‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏£‡∏¥‡∏á‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà .png
    ansImg.style.display = 'block';
  }

  // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÅ‡∏ü‡∏•‡∏ä (‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏•‡∏≤‡∏™ .flash-in / .flash-in-cover ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°)
  const playFlashIn = (el, cover = false)=>{
    if(!el) return;
    el.classList?.remove('flash-in','flash-in-cover');
    void el.offsetWidth;
    el.classList?.add(cover ? 'flash-in-cover' : 'flash-in');
    el.addEventListener?.('animationend', ()=> el.classList?.remove('flash-in','flash-in-cover'), { once:true });
  };
  playFlashIn(ansImg, true);
  playFlashIn(toast, false);

  // ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ RESULT_MS ‡πÄ‡∏î‡∏¥‡∏°
  setTimeout(()=>{
    toast.style.display = 'none';
    if(ansImg) ansImg.style.display = 'none';
  }, RESULT_MS);
}




  function startTimebar(){ timeLeft = ROUND_TIME; timebar.style.width = '0%'; timebarWrap.style.opacity = '1'; }
  function stopTimebar(){ timebar.style.width='0%'; }
  function updateTimebar(){
  // frac = ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠" (1 = ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ï‡πá‡∏°, 0 = ‡∏´‡∏°‡∏î)
  const frac = Math.max(0, Math.min(1, timeLeft / ROUND_TIME));

  // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á "‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ" ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
  const elapsed = 1 - frac;
  timebar.style.width = (elapsed * 100).toFixed(1) + '%';

  // ‡∏™‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏•‡∏≠‡∏î: ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (120¬∞) ‚Üí ‡πÅ‡∏î‡∏á (0¬∞) ‡∏ï‡∏≤‡∏° "‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠"
  const hue = 120 * frac; // 120=‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, 0=‡πÅ‡∏î‡∏á
  const col = `hsl(${hue}, 90%, 45%)`;
  timebar.style.backgroundColor = col;

  // (‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å) ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡∏µ
  // timebar.style.boxShadow = `0 0 12px ${col}66`;
}


  function dropQuestion(text){
    const qImg = document.getElementById('questionImg');
    qBox.textContent = String(text).replace(/\s*\|\s*/g, '\n'); 
// ‡πÉ‡∏ä‡πâ '|' ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏Ñ‡∏±‡πà‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ‚Üí ‡∏à‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô \n
    qImg.style.display = 'block';
    qBox.style.display = 'block';
    qBox.style.transition = 'none';
    qImg.style.transition = 'none';
    qBox.style.top = '-200px';
    qImg.style.top = '-300px';
    qBox.style.opacity = '1';
    qImg.style.opacity = '1';
    qImg.onload = null;
    qImg.src = 'image/Q1.png';
    requestAnimationFrame(()=>{
      void qBox.offsetWidth; void qImg.offsetWidth;
      requestAnimationFrame(()=>{
        const easing = `top ${Q_DROP_MS}ms cubic-bezier(.2,.9,.2,1)`;
        qBox.style.transition = easing;
        qImg.style.transition = easing;
        qImg.style.top = '20px';
        qBox.style.top = '60px';
      });
    });
  }

 /* ---------- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏±‡∏á (‡∏£‡∏±‡∏ö‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î) ---------- */
function spawnOptions(correct, wrongs){
  // ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 4 ‡∏ï‡∏±‡∏ß (‡∏Å‡∏±‡∏ô‡∏û‡∏•‡∏≤‡∏î‡∏ñ‡πâ‡∏≤‡πÉ‡∏™‡πà wrong ‡∏°‡∏≤‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö)
  const wrongArr = Array.isArray(wrongs) ? wrongs.slice(0, 3) : [];
  while (wrongArr.length < 3) wrongArr.push('‚Äî');
  const items = shuffle([correct, ...wrongArr]);

  // 0=‡∏ö‡∏ô‡∏ã‡πâ‡∏≤‡∏¢, 1=‡∏•‡πà‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢, 2=‡∏ö‡∏ô‡∏Ç‡∏ß‡∏≤, 3=‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤
  const midY  = Math.round(window.innerHeight * 0.58);
  const laneY = [ -70, +70, -70, +70 ];
  const leftStop  = 40;
  const rightStop = window.innerWidth - 40;

  // ‚úÖ ‡∏Ñ‡∏á logic ‡∏™‡∏Å‡∏¥‡∏ô + ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏ß‡πâ‡∏Ñ‡∏£‡∏ö
  const SKINS = [
    { file:'image/A1.png', lx:60, ly:46, labelScale:0.16 },
    { file:'image/A2.png', lx:60, ly:47, labelScale:0.16 },
    { file:'image/A3.png', lx:40, ly:48, labelScale:0.16 },
    { file:'image/A4.png', lx:40, ly:48, labelScale:0.16 },
  ];

  // ‚úÖ ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Æ‡∏¥‡∏ï‡∏ö‡πá‡∏≠‡∏Å‡∏ã‡πå/‡∏≠‡∏≠‡∏ü‡πÄ‡∏ã‡πá‡∏ï (‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏Ñ‡∏∏‡∏ì)
  const TUNING = [
    { w:448, h:308, imgX:-70, imgY:-150, labelX:0, labelY:-200 },
    { w:448, h:308, imgX:-70, imgY:10,   labelX:0, labelY:  0 },
    { w:448, h:308, imgX:70,  imgY:-150, labelX:0, labelY:-200 },
    { w:448, h:308, imgX:70,  imgY:10,   labelX:0, labelY: -6 },
  ];

  for (let i = 0; i < 4; i++) {
    const el = document.createElement('div');
    el.className = 'option ' + (i < 2 ? 'left' : 'right');

    const isCorrect = (items[i] === correct);
    el.dataset.correct = String(isCorrect);

    const img = document.createElement('img');
    img.className = 'opt-bg';
    img.src = SKINS[i].file;
    img.alt = `‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ${i+1}`;

    const label = document.createElement('span');
label.className = 'opt-label';
label.innerHTML = (items[i] || "").replace(/\n/g, "<br>");


    el.appendChild(img);
    el.appendChild(label);

    // ‡∏ß‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏•‡∏ô
    el.style.top = (midY + laneY[i]) + 'px';

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏≠‡∏Å‡∏à‡∏≠
    if (i < 2) { el.style.left  = '-320px'; el.style.right = ''; }
    else       { el.style.right = '-320px'; el.style.left  = ''; }

    // ‡∏¢‡∏¥‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ CSS variables (‡∏Æ‡∏¥‡∏ï‡∏ö‡πá‡∏≠‡∏Å‡∏ã‡πå + ‡∏≠‡∏≠‡∏ü‡πÄ‡∏ã‡πá‡∏ï)
    const t = TUNING[i] || {};
    if (t.w != null)      el.style.setProperty('--img-w', `${t.w}px`);
    if (t.h != null)      el.style.setProperty('--img-h', `${t.h}px`);
    if (t.imgX != null)   el.style.setProperty('--opt-offset-x', `${t.imgX}px`);
    if (t.imgY != null)   el.style.setProperty('--opt-offset-y', `${t.imgY}px`);
    if (t.labelX != null) el.style.setProperty('--label-offset-x', `${t.labelX}px`);
    if (t.labelY != null) el.style.setProperty('--label-offset-y', `${t.labelY}px`);

    // ‚úÖ ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå (‡∏ù‡∏±‡∏á‡πÑ‡∏õ‡∏Å‡∏±‡∏ö‡∏™‡∏Å‡∏¥‡∏ô)
    const skin = SKINS[i] || {};
    el.style.setProperty('--label-left', (skin.lx ?? 50) + '%');
    el.style.setProperty('--label-top',  (skin.ly ?? 50) + '%');

    // ‚úÖ ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡∏à‡∏£‡∏¥‡∏á
    function sizeLabel() {
      const box = el.getBoundingClientRect();
      const scale = skin.labelScale ?? 0.16; // 16% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á
      label.style.fontSize = Math.round(box.height * scale) + 'px';
    }
    requestAnimationFrame(sizeLabel);
    window.addEventListener('resize', sizeLabel);

    game.appendChild(el);

    // 2 ‡πÄ‡∏ü‡∏£‡∏°‡πÉ‡∏´‡πâ transition ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
    requestAnimationFrame(() => {
      void el.offsetWidth;
      requestAnimationFrame(() => {
        if (i < 2) { el.style.left  = leftStop + 'px'; }
        else       { el.style.right = (window.innerWidth - rightStop) + 'px'; }
      });
    });

    el.addEventListener('click', () => tryAnswer(el));
  }
}


  function tryAnswer(el){
  if(!awaitingAnswer) return;

    // ‚úÖ ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤: ‡πÄ‡∏Å‡πá‡∏ö "‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"
  selectedEl   = el;
  selectedText = (el.textContent || '').trim();
  selectedOk   = (el.dataset.correct === 'true');

  // ‚úÖ ‡πÉ‡∏™‡πà‡πÄ‡∏á‡∏≤‡∏ó‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏â‡∏•‡∏¢)
  clearOptionGlows();
  const img = el.querySelector('.opt-bg');
  glowGold(img);
  playSelect(); // ‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å

  // ‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•‡πÑ‡∏ß‡πâ‡∏£‡∏≠ ‚Äú‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‚Äù ‡∏Ñ‡πà‡∏≠‡∏¢‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô
  selectedEl = el;
  selectedText = (el.textContent||'').trim();
  selectedOk = (el.dataset.correct === 'true');

  // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å ‚Äú‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏à‡πÑ‡∏î‡πâ‚Äù ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤
  // ‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î if(selectedEl) return; ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô selectedEl/selectedText/selectedOk ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà
}

function playSelect(){
  try{
    (selectSound?.cloneNode(true)).play?.();
  }catch(_){}
}


  function endRound(ok, pickText, timeout=false){
  clearInterval(roundTimer);
  stopTimebar();

  // ‚úÖ ‡∏¢‡πâ‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏°‡∏≤‡πÑ‡∏ß‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
try{ hitSound?.cloneNode(true).play?.() }catch(_){}  
if(ok){
    score++;
  }
  updateHUD();

  // ‡πÉ‡∏´‡∏°‡πà: ‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡πá‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå 3 ‡∏™‡πà‡∏ß‡∏ô (‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° / ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å / ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå)
const qText = (qBox.textContent || '')
  .replace(/\s*=\s*.*$/,'')      // ‡∏Å‡∏±‡∏ô‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏°‡∏µ '=' ‡∏ï‡∏¥‡∏î‡∏°‡∏≤ ‚Üí ‡∏ï‡∏±‡∏î‡∏ó‡∏¥‡πâ‡∏á
  .replace(/\s*\n\s*/g, ' ')     // ‡∏ö‡∏µ‡∏ö \n ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
  .trim();

const picked = (pickText && pickText.trim()) ? pickText.trim() : '‚Äî';

showToast({ q: qText, a: picked, ok });
    setTimeout(() => {
      const fadeOutInstant = (el) => {
        if (!el) return;
        el.style.transition = 'none';
        el.style.willChange = 'auto';
        void el.offsetWidth;
        el.style.opacity = '0';
        el.style.pointerEvents = 'none';
      };
      fadeOutInstant(qBox);
      const qImg = document.getElementById('questionImg');
      fadeOutInstant(qImg);
      document.querySelectorAll('.option').forEach(fadeOutInstant);
      timebarWrap.style.opacity = '0';

      const flash = document.getElementById('flash');
      flash.className = '';
      void flash.offsetWidth;
      flash.classList.add('flash-clear');

      flash.addEventListener('animationend', () => {
        clearRoundObjects();
        qBox.textContent = '';
        const qi = document.getElementById('questionImg');
        qi.style.display = 'none'; qi.removeAttribute('src'); qi.style.top = '-300px'; qi.style.opacity = '1';
        qBox.style.top = '-200px'; qBox.style.opacity = '1';
        timebarWrap.style.opacity = '1'; toast.style.display = 'none';

        round++; updateHUD();
        if (score >= WIN_SCORE || round >= MAX_ROUNDS) { endLevel(); return; }
        nextRound();
      }, { once: true });
    }, RESULT_MS);
  }

/* ---------- ‡∏Ñ‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Å‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ã‡∏ï) ---------- */
/* ‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ ‡∏ï‡∏≤‡∏°‡∏ü‡∏≠‡∏£‡πå‡πÅ‡∏°‡∏ï‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡πà‡∏≤‡∏á: */

// ===== ‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏î‡πà‡∏≤‡∏ô =====
const QUESTION_BANKS = {
  0: [ // ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 1 : ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏£ (‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°)
    
  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠",
    correct: "‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏Å‡∏ú‡πâ‡∏≤", wrong: ["‡∏Å‡∏≤‡∏£‡∏ã‡∏±‡∏Å‡∏ú‡πâ‡∏≤","‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡πà‡∏ô‡πÅ‡∏´‡πâ‡∏á","‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡πà‡∏ú‡πâ‡∏≤"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠",
    correct: "‡∏ú‡∏¥‡∏ß‡πÅ‡∏´‡πâ‡∏á", wrong: ["‡∏ú‡∏¥‡∏ß‡∏Ñ‡∏•‡πâ‡∏≥","‡∏ú‡∏¥‡∏ß‡∏ä‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πâ‡∏ô","‡∏ú‡∏¥‡∏ß‡∏ï‡∏Å‡∏Å‡∏•‡∏∞"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠",
    correct: "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡∏£‡πå‡πÄ‡∏õ‡πà‡∏≤‡∏ú‡∏°", wrong: ["‡∏Å‡∏≤‡∏£‡∏™‡∏£‡∏∞‡∏ú‡∏°","‡∏Å‡∏≤‡∏£‡∏´‡∏ß‡∏µ‡∏ú‡∏°","‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡πÑ‡∏≠‡∏ô‡πâ‡∏≥"] },

  { question: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠",
    correct: "‡∏õ‡∏•‡∏≤‡∏´‡∏°‡∏∂‡∏Å‡πÅ‡∏´‡πâ‡∏á", wrong: ["‡πÅ‡∏ï‡∏á‡∏Å‡∏ß‡∏≤‡∏î‡∏≠‡∏á","‡∏õ‡∏•‡∏≤‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á","‡∏ã‡∏π‡∏ä‡∏¥"] },

  { question: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ä‡∏ô‡∏¥‡∏î‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠",
    correct: "‡∏•‡∏≥‡πÑ‡∏¢‡∏≠‡∏ö‡πÅ‡∏´‡πâ‡∏á", wrong: ["‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏ß‡∏ô","‡∏°‡∏±‡∏á‡∏Ñ‡∏∏‡∏î‡∏Ñ‡∏±‡∏î","‡∏ß‡∏∏‡πâ‡∏ô‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡πÅ‡∏ô‡πà‡∏ô",
    correct: "‡πÄ‡∏°‡∏Ü", wrong: ["‡∏•‡∏°","‡∏•‡∏π‡∏Å‡πÄ‡∏´‡πá‡∏ö","‡∏ü‡πâ‡∏≤‡∏ú‡πà‡∏≤"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡πÅ‡∏ô‡πà‡∏ô",
    correct: "‡∏ô‡πâ‡∏≥‡πÅ‡∏≠‡∏£‡πå", wrong: ["‡∏Ñ‡∏ß‡∏±‡∏ô‡∏ó‡πà‡∏≠‡πÑ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢","‡∏•‡∏°‡πÅ‡∏≠‡∏£‡πå","‡πÄ‡∏Ç‡∏°‡πà‡∏≤‡∏Ñ‡∏ß‡∏±‡∏ô"] },

   { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡πÅ‡∏ô‡πà‡∏ô",
    correct: "‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡πà‡∏ô‡∏™‡∏∏‡∏£‡∏≤", wrong: ["‡∏Ç‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏ß","‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á","‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏´‡πâ‡∏á"] },

   { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡πÅ‡∏ô‡πà‡∏ô",
    correct: "‡∏ô‡πâ‡∏≥‡∏Ñ‡πâ‡∏≤‡∏á", wrong: ["‡∏ô‡πâ‡∏≥‡πÅ‡∏´‡πâ‡∏á","‡∏ô‡πâ‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏î","‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á"] },

   { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡πÅ‡∏ô‡πà‡∏ô",
    correct: "‡∏ù‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏à‡∏Å", wrong: ["‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏•‡∏∞‡∏•‡∏≤‡∏¢","‡∏Ñ‡∏ß‡∏±‡∏ô‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà","‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏£‡πâ‡∏≠‡∏ô"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡πÅ‡∏ô‡πà‡∏ô",
    correct: "‡∏´‡∏¢‡∏î‡∏ô‡πâ‡∏≥‡∏ö‡∏ô‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡πâ‡∏≥‡πÄ‡∏¢‡πá‡∏ô", wrong: ["‡∏™‡∏£‡∏∞‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≥‡πÅ‡∏´‡πâ‡∏á‡∏•‡∏á","‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡∏≠‡∏á‡∏ú‡∏±‡∏Å","‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡∏á‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å"] },

   { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡πÅ‡∏ô‡πà‡∏ô",
    correct: "‡∏ù‡∏ô", wrong: ["‡∏•‡∏π‡∏Å‡πÄ‡∏´‡πá‡∏ö","‡∏ü‡πâ‡∏≤‡∏£‡πâ‡∏≠‡∏á","‡∏û‡∏≤‡∏¢‡∏∏‡∏´‡∏°‡∏∏‡∏ô"] },

   { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡πÅ‡∏ô‡πà‡∏ô",
    correct: "‡∏´‡∏°‡∏≠‡∏Å", wrong: ["‡∏´‡∏¥‡∏°‡∏∞","‡∏•‡∏≤‡∏ß‡∏≤","‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å\n‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠",
    correct: "‡∏Å‡∏≤‡∏£‡∏â‡∏µ‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏≠‡∏°", wrong: ["‡∏Å‡∏≤‡∏£‡∏õ‡∏∞‡πÅ‡∏õ‡πâ‡∏á","‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡πÇ‡∏•‡∏ä‡∏±‡πà‡∏ô","‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ\n‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡πÑ‡∏î‡πâ",
    correct: "‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏•", wrong: ["‡∏™‡∏ö‡∏π‡πà‡∏Å‡πâ‡∏≠‡∏ô","‡πÅ‡∏Å‡πä‡∏™‡∏´‡∏∏‡∏á‡∏ï‡πâ‡∏°","‡πÅ‡∏õ‡πâ‡∏á‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ\n‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡πÑ‡∏î‡πâ",
    correct: "‡∏ô‡πâ‡∏≥‡∏≠‡∏±‡∏î‡∏•‡∏°", wrong: ["‡∏î‡∏¥‡∏ô","‡πÉ‡∏ö‡πÑ‡∏°‡πâ","‡∏ú‡∏á‡∏ã‡∏±‡∏Å‡∏ü‡∏≠‡∏Å"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ\n‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡πÑ‡∏î‡πâ",
    correct: "‡∏ô‡πâ‡∏≥‡∏´‡∏≠‡∏°", wrong: ["‡πÄ‡∏´‡∏•‡πá‡∏Å","‡πÅ‡∏Å‡πä‡∏™‡πÑ‡∏ô‡πÇ‡∏ï‡∏£‡πÄ‡∏à‡∏ô","‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ\n‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡πÑ‡∏î‡πâ",
    correct: "‡πÑ‡∏ô‡πÇ‡∏ï‡∏£‡πÄ‡∏à‡∏ô‡πÄ‡∏´‡∏•‡∏ß", wrong: ["‡∏û‡∏£‡∏¥‡∏Å‡∏õ‡πà‡∏ô","‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏û‡∏∑‡∏ä","‡πÄ‡∏Å‡∏•‡∏∑‡∏≠"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ\n‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡πÑ‡∏î‡πâ",
    correct: "‡∏Å‡∏≤‡πÅ‡∏ü", wrong: ["‡πÄ‡∏°‡∏•‡πá‡∏î‡∏Å‡∏≤‡πÅ‡∏ü","‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏µ‡∏¢‡∏°","‡πÄ‡∏õ‡∏•‡∏ß‡πÑ‡∏ü"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ\n‡∏£‡∏∞‡πÄ‡∏´‡∏¥‡∏î‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡πÑ‡∏î‡πâ",
    correct: "‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏´‡πâ‡∏á", wrong: ["‡∏ó‡∏£‡∏≤‡∏¢","‡πÄ‡∏´‡πá‡∏î-‡∏£‡∏≤","‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å"] },

{ question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ\n‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡πÑ‡∏î‡πâ",
    correct: "‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏≠‡∏°‡∏£‡∏∞‡πÄ‡∏´‡∏¢", wrong: ["‡∏Ç‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏ß","‡∏ú‡πâ‡∏≤","‡∏•‡∏≤‡∏ß‡∏≤"] },
  ],

  1: [ // ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà 2 : ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏£  ‚úÖ (‡πÉ‡∏´‡∏°‡πà)
      { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡∏ô‡πâ‡∏≥‡∏™‡∏∞‡∏≠‡∏≤‡∏î", wrong: ["‡∏ó‡∏£‡∏≤‡∏¢","‡πÅ‡∏Å‡πä‡∏™‡∏Æ‡∏µ‡πÄ‡∏•‡∏µ‡∏¢‡∏°","‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏û‡∏∑‡∏ä", wrong: ["‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ó‡πà‡∏á","‡∏≠‡∏≤‡∏Å‡∏≤‡∏®","‡πÑ‡∏°‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏•", wrong: ["‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÄ‡∏°‡πá‡∏î","‡∏Å‡πä‡∏≤‡∏ã‡πÑ‡∏ô‡πÇ‡∏ï‡∏£‡πÄ‡∏à‡∏ô","‡∏≠‡∏¥‡∏ê‡∏ö‡∏•‡πá‡∏≠‡∏Å"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°‡∏™‡∏≤‡∏¢‡∏ä‡∏π", wrong: ["‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏ó‡∏£‡∏≤‡∏¢","‡πÑ‡∏≠‡∏ô‡πâ‡∏≥","‡∏¢‡∏≤‡∏á‡∏•‡∏ö"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡∏ô‡∏°", wrong: ["‡∏î‡∏¥‡∏ô‡πÅ‡∏´‡πâ‡∏á","‡∏Å‡πä‡∏≤‡∏ã‡πÇ‡∏û‡∏£‡πÄ‡∏û‡∏ô","‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡πÑ‡∏°‡πâ"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡∏õ‡∏£‡∏≠‡∏ó", wrong: ["‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á","‡∏Å‡πä‡∏≤‡∏ã‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô","‡∏î‡∏¥‡∏ô‡∏™‡∏≠"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤", wrong: ["‡∏Ñ‡∏ß‡∏±‡∏ô‡∏£‡∏ñ","‡∏´‡∏¥‡∏ô‡∏≠‡πà‡∏≠‡∏ô","‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡πÅ‡∏Ç‡πá‡∏á"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡∏ô‡πâ‡∏≥‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°", wrong: ["‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÅ‡∏Å‡∏á","‡πÇ‡∏≠‡πÇ‡∏ã‡∏ô","‡∏≠‡∏¥‡∏ê‡∏°‡∏≠‡∏ç"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏•‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏ô", wrong: ["‡∏ó‡∏£‡∏≤‡∏¢‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å","‡∏Æ‡∏µ‡πÄ‡∏•‡∏µ‡∏¢‡∏°‡∏Å‡πä‡∏≤‡∏ã","‡∏ó‡∏≠‡∏á‡πÅ‡∏î‡∏á‡∏•‡∏ß‡∏î"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß",
    correct: "‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á", wrong: ["‡∏Å‡πâ‡∏≠‡∏ô‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•","‡∏≠‡∏≤‡∏Å‡∏≤‡∏®","‡∏ñ‡πà‡∏≤‡∏ô‡∏´‡∏¥‡∏ô"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÅ‡∏Å‡∏á", wrong: ["‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á","‡∏Å‡πä‡∏≤‡∏ã‡πÑ‡∏ô‡πÇ‡∏ï‡∏£‡πÄ‡∏à‡∏ô","‡∏ô‡πâ‡∏≥"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏ó‡∏£‡∏≤‡∏¢", wrong: ["‡πÑ‡∏≠‡∏ô‡πâ‡∏≥","‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå","‡∏≠‡∏≤‡∏Å‡∏≤‡∏®"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡∏Å‡∏£‡∏∞‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á", wrong: ["‡∏ô‡πâ‡∏≥‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°","‡πÇ‡∏û‡∏£‡πÄ‡∏û‡∏ô","‡∏ô‡∏°"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô", wrong: ["‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°‡∏™‡∏≤‡∏¢‡∏ä‡∏π","‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÑ‡∏î‡∏≠‡∏≠‡∏Å‡πÑ‡∏ã‡∏î‡πå","‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏û‡∏∑‡∏ä"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡πÑ‡∏°‡πâ‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô", wrong: ["‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤","‡∏Æ‡∏µ‡πÄ‡∏•‡∏µ‡∏¢‡∏°‡∏Å‡πä‡∏≤‡∏ã","‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏•‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏ô"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡πâ‡∏≥ (‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÅ‡∏Å‡πâ‡∏ß)", wrong: ["‡∏ô‡∏°","‡πÑ‡∏≠‡∏ô‡πâ‡∏≥","‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡∏¢‡∏≤‡∏á‡∏•‡∏ö", wrong: ["‡∏ô‡πâ‡∏≥","‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡∏Å‡πä‡∏≤‡∏ã","‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡∏Ç‡∏ß‡∏î‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å", wrong: ["‡∏ô‡πâ‡∏≥‡∏ù‡∏ô","‡∏≠‡∏≤‡∏Å‡∏≤‡∏®","‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á", wrong: ["‡∏õ‡∏£‡∏≠‡∏ó","‡πÑ‡∏≠‡∏ô‡πâ‡∏≥","‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°‡∏™‡∏≤‡∏¢‡∏ä‡∏π"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏Ç‡πá‡∏á",
    correct: "‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á", wrong: ["‡∏ô‡πâ‡∏≥‡∏≠‡∏∏‡πà‡∏ô","‡∏Å‡πä‡∏≤‡∏ã‡πÇ‡∏≠‡πÇ‡∏ã‡∏ô","‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏û‡∏∑‡∏ä"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡∏Æ‡∏µ‡πÄ‡∏•‡∏µ‡∏¢‡∏°‡πÉ‡∏ô‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á", wrong: ["‡∏ô‡πâ‡∏≥‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°","‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÅ‡∏Å‡∏á","‡πÑ‡∏°‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡∏Å‡πä‡∏≤‡∏ã‡πÑ‡∏ô‡πÇ‡∏ï‡∏£‡πÄ‡∏à‡∏ô", wrong: ["‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏û‡∏∑‡∏ä","‡∏´‡∏¥‡∏ô‡∏≠‡πà‡∏≠‡∏ô","‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏ó‡∏£‡∏≤‡∏¢"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡∏Å‡πä‡∏≤‡∏ã‡πÑ‡∏Ç‡πà‡πÄ‡∏ô‡πà‡∏≤", wrong: ["‡∏ô‡∏°","‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡πâ‡∏≥","‡∏ó‡∏£‡∏≤‡∏¢"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÑ‡∏î‡∏≠‡∏≠‡∏Å‡πÑ‡∏ã‡∏î‡πå", wrong: ["‡∏ô‡πâ‡∏≥‡∏™‡πâ‡∏°‡∏™‡∏≤‡∏¢‡∏ä‡∏π","‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á","‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏•‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏ô"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡∏Å‡πä‡∏≤‡∏ã‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô", wrong: ["‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á","‡∏õ‡∏£‡∏≠‡∏ó","‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡πÇ‡∏û‡∏£‡πÄ‡∏û‡∏ô (‡πÅ‡∏Å‡πä‡∏™‡∏´‡∏∏‡∏á‡∏ï‡πâ‡∏°)", wrong: ["‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤","‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÄ‡∏°‡πá‡∏î","‡∏Å‡πâ‡∏≠‡∏ô‡∏≠‡∏¥‡∏ê"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡∏ï‡∏î", wrong: ["‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á","‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ó‡πà‡∏á","‡∏ô‡πâ‡∏≥"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡∏Å‡πä‡∏≤‡∏ã‡πÑ‡∏Æ‡πÇ‡∏î‡∏£‡πÄ‡∏à‡∏ô", wrong: ["‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á","‡∏Å‡∏£‡∏∞‡∏à‡∏Å","‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏Å‡πâ‡∏≠‡∏ô"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡πÑ‡∏≠‡∏ô‡πâ‡∏≥", wrong: ["‡∏ô‡∏°‡∏Ç‡πâ‡∏ô‡∏´‡∏ß‡∏≤‡∏ô","‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏¥‡∏ô","‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÅ‡∏Å‡∏á"] },

  { question: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î\n‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πä‡∏≤‡∏ã",
    correct: "‡∏≠‡∏≤‡∏Å‡∏≤‡∏®", wrong: ["‡∏ô‡πâ‡∏≥‡∏™‡∏∞‡∏≠‡∏≤‡∏î","‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡πà‡∏á","‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á"] },
  ]
};

// ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏Å‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö (‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ã‡πá‡∏ï‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πà‡∏≤‡∏ô)
let QUESTION_BANK = [];


/* ---------- ‡∏™‡∏∏‡πà‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ï‡∏≤‡∏°‡∏Å‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ---------- */
let __qOrder = [];
let __qIdx = 0;

function shuffle(arr){
  const A = arr.slice();
  for(let i=A.length-1;i>0;i--){
    const j=(Math.random()*(i+1))|0;
    [A[i],A[j]]=[A[j],A[i]];
  }
  return A;
}

function drawQuestion(){
  if (!QUESTION_BANK.length){
    return { question:"(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°)", correct:"-", wrong:["x","x","x"] };
  }
  if (!__qOrder.length || __qIdx >= __qOrder.length){
    __qOrder = shuffle([...Array(QUESTION_BANK.length).keys()]);
    __qIdx = 0;
  }
  const q = QUESTION_BANK[ __qOrder[__qIdx] ];
  __qIdx++;
  return q; // {question, correct, wrong}
}



  function nextRound(){
  clearRoundObjects(); 
  awaitingAnswer=false; 
  stopTimebar();
  selectedEl = null;
  selectedText = '';
  selectedOk = null;

  qBox.textContent=''; 
  qBox.style.top='-200px';

  setTimeout(()=>{
    // ‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏à‡∏≤‡∏Å ‚Äú‡∏Å‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‚Äù
    const { question, correct, wrong } = drawQuestion();
    correctThisRound = correct;

    dropQuestion(question);

    setTimeout(()=>{
      // ‚úÖ ‡∏™‡πà‡∏á‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå (‡∏¢‡∏±‡∏á‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
      spawnOptions(correct, wrong);

      setTimeout(()=>{
        startTimebar();
        startRoundTimer();
      }, OPT_IN_MS);
    }, Q_DROP_MS + Q_HOLD_MS);

  }, BLANK_MS);
}


  function startRoundTimer(){
    timeLeft = ROUND_TIME; awaitingAnswer=true; updateTimebar();
    const TICK=100; let last = performance.now();
    roundTimer = setInterval(()=>{
      const now = performance.now(); const dt = (now-last)/1000; last=now;
      timeLeft -= dt; updateTimebar();
      if(timeLeft<=0){
  awaitingAnswer=false;
  clearInterval(roundTimer);

  // ‚úÖ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏ä‡πâ‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å; ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤ ‚Äú‡∏ú‡∏¥‡∏î‚Äù
  const ok = (selectedOk === true);
  const txt = selectedText || '';

  endRound(ok, txt, true);
}

    }, TICK);
  }

  function startGame(){
  // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡∏î‡πà‡∏≤‡∏ô
  QUESTION_BANK = QUESTION_BANKS[selectedLevel] || [];
  __qOrder = []; __qIdx = 0;          // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà

  running=true; ended=false; paused=false;
  overlay.classList.remove('show');
  score=0; round=0; updateHUD();
  bgm?.play?.().catch(()=>{});
  nextRound();
}

  function endLevel(){ ended=true; running=false; finalScoreEl.textContent=String(score); finalRoundsEl.textContent=String(round); bgm?.pause?.(); winSound?.play?.().catch(()=>{}); overlay.classList.add('show') }

  function pauseGame(){ if(!running||paused) return; paused=true; clearInterval(roundTimer); bgm?.pause?.(); document.querySelectorAll('.option').forEach(n=> n.style.pointerEvents='none'); }
  function resumeGame(){ if(!paused||ended) return; paused=false; document.querySelectorAll('.option').forEach(n=> n.style.pointerEvents='auto'); startRoundTimer(); bgm?.play?.().catch(()=>{}); }

  document.getElementById('pauseBtn')?.addEventListener('click', ()=>{ if(!paused){ pauseGame(); document.getElementById('pauseBtn').textContent='‚ñ∂Ô∏è ‡∏ï‡πà‡∏≠'; } else { resumeGame(); document.getElementById('pauseBtn').textContent='‚è∏ ‡∏´‡∏¢‡∏∏‡∏î'; } });
  document.getElementById('quickRestart')?.addEventListener('click', ()=> location.reload());

  restartBtn.addEventListener('click', ()=>{ overlay.classList.remove('show'); resetState(); startGame() });
  selectLevelBtn.addEventListener('click', ()=>{ overlay.classList.remove('show'); resetState(); document.getElementById('landing').classList.remove('hide'); document.getElementById('startScreen').style.display='none' });
  nextLevelBtn.addEventListener('click', ()=>{ selectedLevel = (selectedLevel+1)%4; overlay.classList.remove('show'); resetState(); openStartForLevel(true) });

  // start screen + landing
  const startScreen  = document.getElementById('startScreen');
  const startTitle   = document.getElementById('startTitle');
  const startBtn     = document.getElementById('startBtn');
  const countdownEl  = document.getElementById('countdown');

  function openStartForLevel(autoCountdown=true){
    const L = LEVELS[selectedLevel]; startTitle.textContent = L.mission;
    startScreen.style.display='flex';
    if(autoCountdown){
      let n=3; countdownEl.textContent=n; countdownEl.style.display='block';
      const itv=setInterval(()=>{ n--; if(n>0){countdownEl.textContent=n}else{ clearInterval(itv); startScreen.style.display='none'; startGame() } },1000)

    } else {
  // ‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏≠‡∏á
  startBtn.disabled = false;
  startBtn.style.pointerEvents = 'auto';
  startBtn.style.display = 'inline-block';
  countdownEl.style.display = 'none';
}

  }
  startBtn?.addEventListener('click', ()=>{
  if (startBtn.disabled) return;          // ‡∏Å‡∏±‡∏ô‡∏Å‡∏î‡∏£‡∏±‡∏ß
  startBtn.disabled = true;               // ‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‡∏à‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
  startBtn.style.pointerEvents = 'none';

  startBtn.style.display='none';
  let n = 3;
  countdownEl.textContent = n;
  countdownEl.style.display = 'block';

  const itv = setInterval(()=>{
    n--;
    if(n>0){
      countdownEl.textContent = n;
    }else{
      clearInterval(itv);
      startScreen.style.display = 'none';
      startGame();

      // (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡∏°‡πà‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å openStartForLevel)
      startBtn.disabled = false;
      startBtn.style.pointerEvents = 'auto';
    }
  }, 1000);
});

  // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πà‡∏≤‡∏ô
  const LEVELS = [
    { id:0, mission:"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á" },
    { id:1, mission:"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á" },
  ];

  document.querySelectorAll('.levelBtn').forEach(btn=>{
    if(btn.id==='guideBtn') return;
    btn.addEventListener('click', ()=>{
      selectedLevel = parseInt(btn.getAttribute('data-level'),10) || 0;
      document.getElementById('landing').classList.add('hide');
      openStartForLevel(false);
    });
  });
  document.getElementById('guideBtn')?.addEventListener('click', ()=>{ document.getElementById('landing').classList.add('hide'); document.getElementById('guideScreen').style.display='flex' });
  document.getElementById('guideBack')?.addEventListener('click', ()=>{ document.getElementById('guideScreen').style.display='none'; document.getElementById('landing').classList.remove('hide') });

  // visibility pause
  let wasRunningBeforeHide=false;
  function uiBlockingOpen(){
    const landing=document.getElementById('landing');
    const startOpen = startScreen && startScreen.style.display!=='none';
    const guide=document.getElementById('guideScreen');
    const guideOpen = getComputedStyle(guide).display!=='none';
    const overlayOpen=overlay.classList.contains('show');
    return overlayOpen||(!landing.classList.contains('hide'))||startOpen||guideOpen
  }
  function handleHidden(){ wasRunningBeforeHide = running && !ended && !uiBlockingOpen(); if(wasRunningBeforeHide) pauseGame() }
  function handleVisible(){ if(wasRunningBeforeHide && paused && !ended && !uiBlockingOpen()) resumeGame(); wasRunningBeforeHide=false }
  document.addEventListener('visibilitychange', ()=>{ if(document.hidden) handleHidden(); else handleVisible() });
  window.addEventListener('blur', handleHidden); window.addEventListener('focus', handleVisible);

  window.__MCGAME__ = { tryAnswer, startGame };
})();
</script>

<!-- ===== ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á ===== -->
<script>
(function(){
  const micBtn   = document.getElementById('micBtn');
  const voicePill= document.getElementById('voicePill');
  if(!micBtn) return;
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  if(!SR){ micBtn.textContent='üé§ ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö'; micBtn.disabled=true; return }
  let askedOnce=false, keepListening=false, recognizing=false;
  const rec = new SR(); rec.lang='th-TH'; rec.continuous=true; rec.interimResults=true;
  function showListening(on){ micBtn.textContent = on? 'üé§ ‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ‡πÄ‡∏õ‡∏¥‡∏î':'üé§ ‡πÄ‡∏™‡∏µ‡∏¢‡∏á: ‡∏õ‡∏¥‡∏î'; if(voicePill) voicePill.style.display = on? 'inline-block':'none' }
  function tokensFrom(s){ s=(s||'').toLowerCase().trim(); s=s.replace(/\s*(‡∏Ñ‡πà‡∏∞|‡∏Ñ‡∏£‡∏±‡∏ö|‡∏Ñ‡∏∞|‡∏Æ‡∏∞)$/,''); return s.split(/[\s,Ôºå„ÄÇ\.!?:;„ÄÅ]+/).filter(Boolean) }
  function currentOptionsMap(){ const map=new Map(); document.querySelectorAll('.option').forEach(n=>{ const t=(n.textContent||'').trim().toLowerCase(); if(!map.has(t)) map.set(t,[]); map.get(t).push(n) }); return map }
  function pickNearest(arr){ return arr[0] }
  function tryFire(phrase){ const toks=tokensFrom(phrase); if(!toks.length) return false; const cmap=currentOptionsMap(); for(const t of toks){ if(cmap.has(t)){ const node = pickNearest(cmap.get(t)); node?.click(); return true } } return false }
  rec.onresult=(e)=>{ for(let i=e.resultIndex;i<e.results.length;i++){ const r=e.results[i]; const txt=(r[0]?.transcript||'').trim(); if(!txt) continue; tryFire(txt) } };
  rec.onstart=()=>{ recognizing=true; showListening(true) };
  rec.onend=()=>{ recognizing=false; showListening(false); if(keepListening && !document.hidden){ setTimeout(()=>{ try{rec.start()}catch(_){} }, 200) } };
  rec.onerror=(e)=>{ if(e?.error==='not-allowed'){ micBtn.textContent='üé§ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï'; micBtn.disabled=true } };
  async function ensureMicPermissionOnce(){ if(askedOnce) return; askedOnce=true; try{ const s=await navigator.mediaDevices.getUserMedia({audio:true}); s.getTracks().forEach(t=>t.stop()) }catch(_){ micBtn.textContent='üé§ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï'; micBtn.disabled=true; throw _ } }
  function startListen(){ keepListening=true; try{ rec.start() }catch(_){} }
  function stopListen(){ keepListening=false; try{ rec.stop() }catch(_){} }
  micBtn.addEventListener('click', async ()=>{ if(keepListening){ stopListen(); return } try{ await ensureMicPermissionOnce(); startListen() }catch(_){} });
  document.addEventListener('visibilitychange', ()=>{ if(document.hidden){ if(recognizing) try{ rec.stop() }catch(_){} } else if(keepListening){ setTimeout(()=>{ try{ rec.start() }catch(_){ } }, 150) } });
})();
</script>

<!-- ===== Pose (‡∏°‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÅ‡∏ï‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå) ===== -->
<script type="module">
import {PoseLandmarker, FilesetResolver} from "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3";
const camBtn = document.getElementById('camBtn');
const video  = document.getElementById('cameraMirror');
const cvs    = document.getElementById('camCanvas');
const ctx    = cvs.getContext('2d', { alpha: true });
const DETECT_W = 320;
let detectCanvas = document.createElement('canvas');
let detectCtx = detectCanvas.getContext('2d', { alpha:false, desynchronized:true });
let CAM_ON=false, landmarker=null, raf=0, stream=null;

function fitCanvas(){ const dpr = CAM_ON? 1 : Math.max(1, window.devicePixelRatio||1); cvs.width=Math.round(innerWidth*dpr); cvs.height=Math.round(innerHeight*dpr); cvs.style.width=innerWidth+'px'; cvs.style.height=innerHeight+'px'; ctx.setTransform(1,0,0,1,0,0); ctx.scale(dpr,dpr) }
fitCanvas(); addEventListener('resize', fitCanvas);
function coverCropRect(){ const vw=video.videoWidth||640, vh=video.videoHeight||480; const sw=innerWidth, sh=innerHeight; const scale=Math.max(sw/vw, sh/vh); const sW=Math.round(sw/scale), sH=Math.round(sh/scale); const sX=Math.round((vw-sW)/2), sY=Math.round((vh-sH)/2); return {sX,sY,sW,sH,vw,vh,sw,sh} }
function mapToScreen(nx,ny){ const {sX,sY,sW,sH,vw,vh,sw,sh} = coverCropRect(); const px=nx*vw, py=ny*vh; const u=(px-sX)/sW, v=(py-sY)/sH; let x=u*sw, y=v*sh; x=sw-x; return {x,y} }
function dist(a,b){ const dx=a.x-b.x, dy=a.y-b.y; return Math.hypot(dx,dy) }

const SHOW_HAND_BALL=false; const lastHitAt=new WeakMap(); const HIT_LOCK_MS=160;
function circleIntersectsRect(cx,cy,r, rc){ const nx=Math.max(rc.left, Math.min(cx, rc.right)); const ny=Math.max(rc.top, Math.min(cy, rc.bottom)); const dx=cx-nx, dy=cy-ny; return (dx*dx+dy*dy)<=r*r }
function hitByCircle(center, r){ const opts=[...document.querySelectorAll('.option')]; for(const n of opts){ const rc=n.getBoundingClientRect(); if(circleIntersectsRect(center.x,center.y,r,rc)){ const t=performance.now(); const last=lastHitAt.get(n)||0; if(t-last<HIT_LOCK_MS) continue; lastHitAt.set(n,t); n.click() } } }

async function ensureLandmarker(){ if(landmarker) return landmarker; const fileset = await FilesetResolver.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3/wasm"); landmarker = await PoseLandmarker.createFromOptions(fileset, { baseOptions:{ modelAssetPath:"https://storage.googleapis.com/mediapipe-models/pose_landmarker/pose_landmarker_lite/float16/1/pose_landmarker_lite.task" }, runningMode:'VIDEO', numPoses:1, minPoseDetectionConfidence:.35, minPosePresenceConfidence:.35, minTrackingConfidence:.35 }); return landmarker }
function drawHandBall(elbowIdx, wristIdx, lm){ if(!lm[elbowIdx]||!lm[wristIdx]) return null; const elbow = mapToScreen(lm[elbowIdx].x, lm[elbowIdx].y); const wrist = mapToScreen(lm[wristIdx].x, lm[wristIdx].y); const r=24; const L=Math.max(1, dist(elbow,wrist)); const ux=(wrist.x-elbow.x)/L, uy=(wrist.y-elbow.y)/L; const HAND_PUSH=1.5, PUSH_PX=6; const center={ x: wrist.x + ux*(r*HAND_PUSH+PUSH_PX), y: wrist.y + uy*(r*HAND_PUSH+PUSH_PX) }; if(SHOW_HAND_BALL){ ctx.beginPath(); ctx.arc(center.x,center.y,r,0,Math.PI*2); ctx.fillStyle='#fff'; ctx.fill(); ctx.lineWidth=3; ctx.strokeStyle='#fff'; ctx.stroke(); } hitByCircle(center, r*.95); return center }
function drawPoseAndColliders(res){ const sw=innerWidth, sh=innerHeight; ctx.clearRect(0,0,sw,sh); if(!res?.landmarks?.length) return; const lm=res.landmarks[0]; drawHandBall(13,15,lm); drawHandBall(14,16,lm) }
function runLoop(){ const step=()=>{ if(!video.videoWidth){ raf=requestAnimationFrame(step); return } const now=performance.now(); try{ const {sX,sY,sW,sH}=coverCropRect(); detectCtx.drawImage(video, sX,sY,sW,sH, 0,0, detectCanvas.width, detectCanvas.height); const res=landmarker.detectForVideo(detectCanvas, now); drawPoseAndColliders(res) }catch(e){} raf=requestAnimationFrame(step) }; raf=requestAnimationFrame(step) }
async function startCamera(){ await ensureLandmarker(); stream = await navigator.mediaDevices.getUserMedia({ video:{ facingMode:'user' }, audio:false }); video.srcObject=stream; await video.play().catch(()=>{}); const vw=video.videoWidth||640, vh=video.videoHeight||480; const ratio=vw/vh; detectCanvas.width=DETECT_W; detectCanvas.height=Math.round(DETECT_W/ratio); video.style.display='block'; cvs.style.display='block'; camBtn.textContent='üì∑ ‡∏Å‡∏•‡πâ‡∏≠‡∏á: ‡πÄ‡∏õ‡∏¥‡∏î'; CAM_ON=true; fitCanvas(); runLoop() }
function stopCamera(){ cancelAnimationFrame(raf); if(stream){ stream.getTracks().forEach(t=>t.stop()); stream=null } try{ video.pause() }catch(e){} video.removeAttribute('srcObject'); video.style.display='none'; cvs.style.display='none'; ctx.clearRect(0,0,innerWidth,innerHeight); camBtn.textContent='üì∑ ‡∏Å‡∏•‡πâ‡∏≠‡∏á: ‡∏õ‡∏¥‡∏î'; CAM_ON=false; fitCanvas() }
camBtn.addEventListener('click', async ()=>{ if(!stream){ try{ await startCamera() }catch(err){ camBtn.textContent='üì∑ ‡∏Å‡∏•‡πâ‡∏≠‡∏á: ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï'; camBtn.disabled=true } } else { stopCamera() } });
document.addEventListener('visibilitychange', ()=>{ if(document.hidden && stream) stopCamera() });
</script>

</body>
</html>
